<div class="card mb-4">
  <div class="card-header d-flex justify-content-between align-items-center">
    <h5 class="mb-0">Release information</h5>
  </div>
  <div class="card-body mb-0">
    <div class="row">
      <div class="col-md-6">
        <p>
          <strong>Project:</strong>
          <a href="{{ as_url(get.projects.view, name=release.project.name) }}">{{ release.project.display_name }}</a>
        </p>
        <p>
          <strong>Label:</strong> {{ release.name }}
        </p>
      </div>
      <div class="col-md-6">
        <p>
          <strong>Created:</strong> {{ format_datetime(release.created) }}
        </p>
        {% if release.vote_manual %}
          <p>
            <strong>Manual vote process:</strong> Yes
          </p>
        {% endif %}
        {% if (phase == "release_candidate_draft") and revision_time %}
          <p>
            <strong>Revision:</strong>
            <a href="{{ as_url(get.revisions.selected, project_name=project_name, version_name=version_name) }}#{{ revision_number }}">
              {{ format_datetime(revision_time) }}
            </a>
            {% if revision_editor %}by {{ revision_editor }}{% endif %}
          </p>
        {% elif release.podling_thread_id %}
          <p>
            <strong>Previous round:</strong>
            <a href="https://lists.apache.org/thread/{{ release.podling_thread_id }}"
               target="_blank">Vote thread</a>
          </p>
        {% endif %}
      </div>
    </div>
    <div class="d-flex flex-wrap gap-2">
      {% if phase == "release_candidate_draft" %}
        <a href="{{ as_url(get.upload.selected, project_name=release.project.name, version_name=release.version) }}"
           title="Upload files to this draft"
           class="btn btn-primary"><i class="bi bi-upload me-1"></i> Upload files</a>

        <a href="{{ as_url(get.download.all_selected, project_name=release.project.name, version_name=release.version) }}"
           title="Download {%- if has_files -%}files{%- else -%}links{%- endif -%}"
           class="btn btn-primary"><i class="bi bi-download me-1"></i> Download
          {% if has_files %}
            files
          {% else %}
            links
          {% endif %}
        </a>
        <a href="{{ as_url(get.revisions.selected, project_name=release.project.name, version_name=release.version) }}"
           title="View revision history"
           class="btn btn-secondary"><i class="bi bi-clock-history me-1"></i> Revisions</a>
        {% if revision_number %}
          {% if has_files and release.project.policy_manual_vote and (ongoing_tasks_count == 0) %}
            <a id="start-vote-button"
               href="{{ as_url(get.manual.start_selected_revision, project_name=release.project.name, version_name=release.version, revision=revision_number) }}"
               title="Start a manual vote on this draft"
               class="btn btn-success"><i class="bi bi-check-circle me-1"></i> Start manual vote</a>
          {% elif has_files and release.project.policy_manual_vote %}
            <a id="start-vote-button"
               href="{{ as_url(get.manual.start_selected_revision, project_name=release.project.name, version_name=release.version, revision=revision_number) }}"
               data-vote-href="{{ as_url(get.manual.start_selected_revision, project_name=release.project.name, version_name=release.version, revision=revision_number) }}"
               title="Background tasks must complete first"
               class="btn btn-success disabled"
               role="button"
               aria-disabled="true"
               tabindex="-1"><i class="bi bi-check-circle me-1"></i> Start manual vote</a>
          {% elif has_files and (not strict_checking_errors) and (ongoing_tasks_count == 0) %}
            <a id="start-vote-button"
               href="{{ as_url(get.voting.selected_revision, project_name=release.project.name, version_name=release.version, revision=revision_number) }}"
               title="Start a vote on this draft"
               class="btn btn-success"><i class="bi bi-check-circle me-1"></i> Start voting</a>
          {% elif has_files and (not strict_checking_errors) %}
            <a id="start-vote-button"
               href="{{ as_url(get.voting.selected_revision, project_name=release.project.name, version_name=release.version, revision=revision_number) }}"
               data-vote-href="{{ as_url(get.voting.selected_revision, project_name=release.project.name, version_name=release.version, revision=revision_number) }}"
               title="Background tasks must complete first"
               class="btn btn-success disabled"
               role="button"
               aria-disabled="true"
               tabindex="-1"><i class="bi bi-check-circle me-1"></i> Start voting</a>
          {% else %}
            <a id="start-vote-button"
               href="#"
               title="Upload files to enable voting"
               class="btn btn-success disabled"
               role="button"
               aria-disabled="true"
               tabindex="-1"><i class="bi bi-check-circle me-1"></i> Start voting</a>
          {% endif %}
        {% endif %}
        <a href="#more-actions" class="btn btn-outline-secondary"><i class="bi bi-gear me-1"></i> More actions</a>
      {% elif phase == "release_candidate" %}
        <a href="{{ as_url(get.download.all_selected, project_name=release.project.name, version_name=release.version) }}"
           class="btn btn-primary"><i class="bi bi-download me-1"></i> Download files</a>
        <a href="{{ as_url(get.file.selected, project_name=release.project.name, version_name=release.version) }}"
           class="btn btn-secondary"><i class="bi bi-eye me-1"></i> View files</a>
        {% if can_resolve and release.vote_manual %}
          <a href="{{ as_url(get.manual.resolve_selected, project_name=release.project.name, version_name=release.version) }}"
             class="btn btn-success"><i class="bi bi-clipboard-check me-1"></i> Resolve vote</a>
        {% elif can_resolve and resolve_form %}
          <form action="{{ as_url(post.resolve.selected, project_name=release.project.name, version_name=release.version) }}"
                method="post"
                class="mb-0">
            {{ csrf_input|safe }}
            <input type="hidden" name="variant" value="tabulate" />
            <button type="submit" class="btn btn-success">
              <i class="bi bi-clipboard-check me-1"></i> Resolve vote
            </button>
          </form>
        {% endif %}
      {% endif %}
    </div>
  </div>
</div>
