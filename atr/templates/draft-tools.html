{% extends "layouts/base.html" %}

{%- block title -%}File tools ~ ATR{%- endblock title -%}

{%- block description -%}Manage a file in the candidate draft using tools.{%- endblock description -%}

{% block content %}
  <a href="{{ as_url(get.compose.selected, project_name=project_name, version_name=version_name) }}"
     class="atr-back-link">‚Üê Back to Compose release</a>

  <div class="p-3 mb-4 bg-light border rounded">
    <h2 class="mt-0">File details</h2>
    <p>
      <strong>Filename:</strong> {{ file_data.filename }}
    </p>
    <p>
      <strong>Size:</strong> {{ format_file_size(file_data.bytes_size) }}
    </p>
    <p class="mb-0">
      <strong>Uploaded:</strong> {{ file_data.uploaded.strftime("%Y-%m-%d %H:%M:%S UTC") }}
    </p>
  </div>

  <h2>Tools</h2>
  <h3>Generate hash files</h3>
  <p>Generate an SHA512 hash file for this file.</p>
  <div class="d-flex gap-2 mb-4">
    {{ sha512_form|safe }}
  </div>

  {% if (file_path.endswith(".tar.gz") or file_path.endswith(".zip") or file_path.endswith(".tgz")) and is_viewing_as_admin_fn(current_user.uid) %}
    <h3>Generate SBOM</h3>
    <p>NOTE: This functionality is currently not available.</p>
    <p>Generate a CycloneDX Software Bill of Materials (SBOM) file for this artifact.</p>
    {{ sbom_form|safe }}
  {% endif %}
{% endblock content %}
